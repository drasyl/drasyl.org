<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode }}">
	{{ partialCached "head.html" . }}
	<body class="blog-page list list-{{ .Type | singularize }}">
		{{ partialCached "header.html" . }}
		<main class="main">

			<!-- Page Title -->
			<div class="page-title" data-aos="fade">
				<div class="container">
					<nav class="breadcrumbs">
						<ol>
							<li><a href="{{ .Site.BaseURL }}">Home</a></li>
							{{ if eq .Section "tags" }}
								<li><a href="{{ "tags" | relURL }}">Tags</a></li>
								<li class="current">{{ .Title | humanize | title }}</li>
							{{ else }}
								<li class="current">Blog</li>
							{{ end }}
						</ol>
					</nav>
					{{ if eq .Section "tags" }}
						<h1>Tag: {{ .Title | humanize | title }}</h1>
					{{ else }}
						<h1>Blog</h1>
					{{ end }}
				</div>
			</div><!-- End Page Title -->

			<div class="container">
				<div class="row">

					<div class="col-lg-8">

						<!-- Blog Posts Section -->
						<section id="blog-posts" class="blog-posts section">

							<div class="container" data-aos="fade-up" data-aos-delay="100">

								{{/* Build paginator over this list's pages */}}
								{{ $pages := sort .Pages "Date" "desc" }}
								{{ $paginator := .Paginate $pages }}

								<div class="row gy-4">

									{{ range $paginator.Pages }}
									<div class="col-lg-6">
										<article>

											{{/* Optimized post image */}}
											{{ $post := . }}
											{{ $imgParam := "" }}
											{{ if .Params.images }}
											  {{ $imgParam = (index .Params.images 0) }}
											{{ else if .Params.image }}
											  {{ $imgParam = .Params.image }}
											{{ end }}
											{{ if $imgParam }}
											  {{ $img := false }}
											  {{ with $imgParam }}
												{{ with $post.Resources.GetMatch (printf "**%s" (path.Base .)) }}
												  {{ $img = . }}
												{{ end }}
											  {{ end }}
											  {{ if (not $img) }}
												{{ with $imgParam }}
												  {{ $clean := strings.TrimPrefix "/" . }}
												  {{ $clean = (strings.TrimPrefix "assets/" $clean) }}
												  {{ with resources.Get $clean }}
													{{ $img = . }}
												  {{ end }}
												{{ end }}
											  {{ end }}

											  <div class="post-img">
												{{ if $img }}
												  {{/* Generate responsive variants */}}
												  {{ $avif800 := $img.Resize "800x q70 avif" }}
												  {{ $avif1200 := $img.Resize "1200x q70 avif" }}
												  {{ $webp800 := $img.Resize "800x q75 webp" }}
												  {{ $webp1200 := $img.Resize "1200x q75 webp" }}
												  {{ $jpg1200 := $img.Resize "1200x q80" }}
												  <picture>
													<source type="image/avif" srcset="{{ $avif800.RelPermalink }} 800w, {{ $avif1200.RelPermalink }} 1200w" sizes="(min-width: 1200px) 50vw, 100vw">
													<source type="image/webp" srcset="{{ $webp800.RelPermalink }} 800w, {{ $webp1200.RelPermalink }} 1200w" sizes="(min-width: 1200px) 50vw, 100vw">
													<img src="{{ $jpg1200.RelPermalink }}" alt="{{ .Title }}" class="img-fluid" width="{{ $jpg1200.Width }}" height="{{ $jpg1200.Height }}" loading="lazy" decoding="async" fetchpriority="low">
												  </picture>
												{{ else }}
												  {{/* Static fallback */}}
												  {{ $clean := strings.TrimPrefix "/" $imgParam }}
												  {{ $abs := printf "static/%s" $clean }}
												  {{ $cfg := false }}
												  {{ if (fileExists $abs) }}
													{{ $cfg = (imageConfig $abs) }}
												  {{ end }}
												  {{ $webpRel := replaceRE "\\.[^./]+$" ".webp" $clean }}
												  {{ $webpAbs := printf "static/%s" $webpRel }}
												  {{ $hasWebp := fileExists $webpAbs }}
												  {{ $avifRel := replaceRE "\\.[^./]+$" ".avif" $clean }}
												  {{ $avifAbs := printf "static/%s" $avifRel }}
												  {{ $hasAvif := fileExists $avifAbs }}
												  <picture>
													{{ if $hasAvif }}
													  <source type="image/avif" srcset="/{{ $avifRel }}" sizes="(min-width: 1200px) 50vw, 100vw">
													{{ end }}
													{{ if $hasWebp }}
													  <source type="image/webp" srcset="/{{ $webpRel }}" sizes="(min-width: 1200px) 50vw, 100vw">
													{{ end }}
													<img src="/{{ $clean }}" alt="{{ .Title }}" class="img-fluid" {{ with $cfg }}width="{{ .Width }}" height="{{ .Height }}"{{ end }} loading="lazy" decoding="async" fetchpriority="low">
												  </picture>
												{{ end }}
											  </div>
											{{ end }}

											<h2 class="title">
												<a href="{{ .RelPermalink }}">{{ .Title }}</a>
											</h2>

											<div class="meta-top">
												<ul>
													{{ if .Params.author }}
													<li class="d-flex align-items-center"><i class="bi bi-person"></i> <a href="{{ .RelPermalink }}">{{ .Params.author }}</a></li>
													{{ end }}
													<li class="d-flex align-items-center"><i class="bi bi-clock"></i> <a href="{{ .RelPermalink }}"><time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "Jan 2, 2006" }}</time></a></li>
													{{ if .Params.comments }}
													<li class="d-flex align-items-center"><i class="bi bi-chat-dots"></i> <a href="{{ .RelPermalink }}">{{ .Params.comments }} Comments</a></li>
													{{ end }}
												</ul>
											</div>

											<div class="content">
												<p>
													{{ .Summary | plainify | truncate 200 }}
												</p>

												<div class="read-more">
													<a href="{{ .RelPermalink }}">Read More</a>
												</div>
											</div>

										</article>
									</div><!-- End post list item -->
									{{ end }}

								</div><!-- End blog posts list -->

							</div>

						</section><!-- /Blog Posts Section -->

						<!-- Pagination Section -->
						{{ if .Paginator }}
						<section id="pagination" class="pagination-2 section">
							<div class="container">
								<div class="d-flex justify-content-center">
								{{ template "_internal/pagination.html" . }}
								</div>
							</div>
						</section><!-- /Pagination Section -->
						{{ end }}

					</div>

					<div class="col-lg-4 sidebar">

						<div class="widgets-container" data-aos="fade-up" data-aos-delay="200">

							<!-- Recent Posts Widget -->
							<div class="recent-posts-widget widget-item">

								<h3 class="widget-title">Recent Posts</h3>

								{{ range first 5 (where .Site.RegularPages "Type" "blog") }}
								<div class="post-item">
									{{/* square 80x80 thumbnail */}}
									{{ $p := . }}
									{{ $thumbParam := "" }}
									{{ if .Params.images }}
									  {{ $thumbParam = (index .Params.images 0) }}
									{{ else if .Params.image }}
									  {{ $thumbParam = .Params.image }}
									{{ end }}
									{{ $thumb := false }}
									{{ with $thumbParam }}
									  {{ with $p.Resources.GetMatch (printf "**%s" (path.Base .)) }}
										{{ $thumb = . }}
									  {{ end }}
									{{ end }}
									{{ if (not $thumb) }}
									  {{ with $thumbParam }}
										{{ $clean := strings.TrimPrefix "/" . }}
										{{ $clean = (strings.TrimPrefix "assets/" $clean) }}
										{{ with resources.Get $clean }}
										  {{ $thumb = . }}
										{{ end }}
									  {{ end }}
									{{ end }}
									{{ if $thumb }}
									  {{ $twebp := $thumb.Fill "160x160 q100 webp" }}
									  {{ $tjpg := $thumb.Fill "160x160 q100" }}
									  <picture>
										<source type="image/webp" srcset="{{ $twebp.RelPermalink }}">
										<img src="{{ $tjpg.RelPermalink }}" alt="{{ .Title }}" class="flex-shrink-0" width="80" height="80" loading="lazy" decoding="async" fetchpriority="low" style="aspect-ratio:1/1; object-fit:cover;">
									  </picture>
									{{ else if $thumbParam }}
									  {{ $clean := strings.TrimPrefix "/" $thumbParam }}
									  {{ $abs := printf "static/%s" $clean }}
									  {{ $cfg := false }}
									  {{ if (fileExists $abs) }}
										{{ $cfg = (imageConfig $abs) }}
									  {{ end }}
									  <img src="/{{ $clean }}" alt="{{ .Title }}" class="flex-shrink-0" width="80" height="80" loading="lazy" decoding="async" fetchpriority="low" style="aspect-ratio:1/1; object-fit:cover;">
									{{ end }}
									<div>
										<h4><a href="{{ .RelPermalink }}">{{ .Title }}</a></h4>
										<time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "Jan 2, 2006" }}</time>
									</div>
								</div><!-- End recent post item-->
								{{ end }}

							</div><!--/Recent Posts Widget -->

							<!-- Tags Widget -->
							<div class="tags-widget widget-item">

								<h3 class="widget-title">Tags</h3>
								<ul>
									{{ range .Site.Taxonomies.tags }}
									<li><a href="{{ .Page.RelPermalink }}">{{ .Page.Title }}</a></li>
									{{ end }}
								</ul>

							</div><!--/Tags Widget -->

						</div>

					</div>

				</div>
			</div>

		</main>
		{{ partialCached "footer.html" . }}

		<!-- Scroll Top -->
		<a href="#" id="scroll-top" class="scroll-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

		<!-- Vendor JS Files -->
		<script src="{{ "vendor/bootstrap/js/bootstrap.bundle.min.js" | relURL }}"></script>
		<script src="{{ "vendor/aos/aos.js" | relURL }}"></script>

		<!-- Main JS File -->
		{{ $script := resources.Get "js/main.js" }}
		<script src="{{ ($script | minify | fingerprint).RelPermalink}}"></script>
	</body>
</html>